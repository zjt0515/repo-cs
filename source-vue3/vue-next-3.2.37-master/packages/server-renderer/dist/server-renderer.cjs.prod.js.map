{"version":3,"file":"server-renderer.cjs.prod.js","sources":["../src/helpers/ssrRenderAttrs.ts","../src/helpers/ssrCompile.ts","../src/helpers/ssrRenderTeleport.ts","../src/render.ts","../src/renderToString.ts","../src/renderToStream.ts","../src/helpers/ssrRenderComponent.ts","../src/helpers/ssrRenderSlot.ts","../src/helpers/ssrInterpolate.ts","../src/helpers/ssrRenderList.ts","../src/helpers/ssrRenderSuspense.ts","../src/helpers/ssrGetDirectiveProps.ts","../src/helpers/ssrVModelHelpers.ts","../src/index.ts"],"sourcesContent":["import { escapeHtml, stringifyStyle } from '@vue/shared'\nimport {\n  normalizeClass,\n  normalizeStyle,\n  propsToAttrMap,\n  isString,\n  isOn,\n  isSSRSafeAttrName,\n  isBooleanAttr,\n  includeBooleanAttr,\n  makeMap\n} from '@vue/shared'\n\n// leading comma for empty string \"\"\nconst shouldIgnoreProp = makeMap(\n  `,key,ref,innerHTML,textContent,ref_key,ref_for`\n)\n\nexport function ssrRenderAttrs(\n  props: Record<string, unknown>,\n  tag?: string\n): string {\n  let ret = ''\n  for (const key in props) {\n    if (\n      shouldIgnoreProp(key) ||\n      isOn(key) ||\n      (tag === 'textarea' && key === 'value')\n    ) {\n      continue\n    }\n    const value = props[key]\n    if (key === 'class') {\n      ret += ` class=\"${ssrRenderClass(value)}\"`\n    } else if (key === 'style') {\n      ret += ` style=\"${ssrRenderStyle(value)}\"`\n    } else {\n      ret += ssrRenderDynamicAttr(key, value, tag)\n    }\n  }\n  return ret\n}\n\n// render an attr with dynamic (unknown) key.\nexport function ssrRenderDynamicAttr(\n  key: string,\n  value: unknown,\n  tag?: string\n): string {\n  if (!isRenderableValue(value)) {\n    return ``\n  }\n  const attrKey =\n    tag && tag.indexOf('-') > 0\n      ? key // preserve raw name on custom elements\n      : propsToAttrMap[key] || key.toLowerCase()\n  if (isBooleanAttr(attrKey)) {\n    return includeBooleanAttr(value) ? ` ${attrKey}` : ``\n  } else if (isSSRSafeAttrName(attrKey)) {\n    return value === '' ? ` ${attrKey}` : ` ${attrKey}=\"${escapeHtml(value)}\"`\n  } else {\n    console.warn(\n      `[@vue/server-renderer] Skipped rendering unsafe attribute name: ${attrKey}`\n    )\n    return ``\n  }\n}\n\n// Render a v-bind attr with static key. The key is pre-processed at compile\n// time and we only need to check and escape value.\nexport function ssrRenderAttr(key: string, value: unknown): string {\n  if (!isRenderableValue(value)) {\n    return ``\n  }\n  return ` ${key}=\"${escapeHtml(value)}\"`\n}\n\nfunction isRenderableValue(value: unknown): boolean {\n  if (value == null) {\n    return false\n  }\n  const type = typeof value\n  return type === 'string' || type === 'number' || type === 'boolean'\n}\n\nexport function ssrRenderClass(raw: unknown): string {\n  return escapeHtml(normalizeClass(raw))\n}\n\nexport function ssrRenderStyle(raw: unknown): string {\n  if (!raw) {\n    return ''\n  }\n  if (isString(raw)) {\n    return escapeHtml(raw)\n  }\n  const styles = normalizeStyle(raw)\n  return escapeHtml(stringifyStyle(styles))\n}\n","import { ComponentInternalInstance, ComponentOptions, warn } from 'vue'\nimport { compile } from '@vue/compiler-ssr'\nimport { extend, generateCodeFrame, isFunction, NO } from '@vue/shared'\nimport { CompilerError, CompilerOptions } from '@vue/compiler-core'\nimport { PushFn } from '../render'\n\ntype SSRRenderFunction = (\n  context: any,\n  push: PushFn,\n  parentInstance: ComponentInternalInstance\n) => void\n\nconst compileCache: Record<string, SSRRenderFunction> = Object.create(null)\n\nexport function ssrCompile(\n  template: string,\n  instance: ComponentInternalInstance\n): SSRRenderFunction {\n  if (!__NODE_JS__) {\n    throw new Error(\n      `On-the-fly template compilation is not supported in the ESM build of ` +\n        `@vue/server-renderer. All templates must be pre-compiled into ` +\n        `render functions.`\n    )\n  }\n\n  // TODO: This is copied from runtime-core/src/component.ts and should probably be refactored\n  const Component = instance.type as ComponentOptions\n  const { isCustomElement, compilerOptions } = instance.appContext.config\n  const { delimiters, compilerOptions: componentCompilerOptions } = Component\n\n  const finalCompilerOptions: CompilerOptions = extend(\n    extend(\n      {\n        isCustomElement,\n        delimiters\n      },\n      compilerOptions\n    ),\n    componentCompilerOptions\n  )\n\n  finalCompilerOptions.isCustomElement =\n    finalCompilerOptions.isCustomElement || NO\n  finalCompilerOptions.isNativeTag = finalCompilerOptions.isNativeTag || NO\n\n  const cacheKey = JSON.stringify(\n    {\n      template,\n      compilerOptions: finalCompilerOptions\n    },\n    (key, value) => {\n      return isFunction(value) ? value.toString() : value\n    }\n  )\n\n  const cached = compileCache[cacheKey]\n  if (cached) {\n    return cached\n  }\n\n  finalCompilerOptions.onError = (err: CompilerError) => {\n    if (__DEV__) {\n      const message = `[@vue/server-renderer] Template compilation error: ${err.message}`\n      const codeFrame =\n        err.loc &&\n        generateCodeFrame(\n          template as string,\n          err.loc.start.offset,\n          err.loc.end.offset\n        )\n      warn(codeFrame ? `${message}\\n${codeFrame}` : message)\n    } else {\n      throw err\n    }\n  }\n\n  const { code } = compile(template, finalCompilerOptions)\n  return (compileCache[cacheKey] = Function('require', code)(require))\n}\n","import { ComponentInternalInstance, ssrContextKey } from 'vue'\nimport { createBuffer, PushFn, SSRBufferItem, SSRContext } from '../render'\n\nexport function ssrRenderTeleport(\n  parentPush: PushFn,\n  contentRenderFn: (push: PushFn) => void,\n  target: string,\n  disabled: boolean,\n  parentComponent: ComponentInternalInstance\n) {\n  parentPush('<!--teleport start-->')\n\n  const context = parentComponent.appContext.provides[\n    ssrContextKey as any\n  ] as SSRContext\n  const teleportBuffers =\n    context.__teleportBuffers || (context.__teleportBuffers = {})\n  const targetBuffer = teleportBuffers[target] || (teleportBuffers[target] = [])\n  // record current index of the target buffer to handle nested teleports\n  // since the parent needs to be rendered before the child\n  const bufferIndex = targetBuffer.length\n\n  let teleportContent: SSRBufferItem\n\n  if (disabled) {\n    contentRenderFn(parentPush)\n    teleportContent = `<!--teleport anchor-->`\n  } else {\n    const { getBuffer, push } = createBuffer()\n    contentRenderFn(push)\n    push(`<!--teleport anchor-->`)\n    teleportContent = getBuffer()\n  }\n\n  targetBuffer.splice(bufferIndex, 0, teleportContent)\n  parentPush('<!--teleport end-->')\n}\n","import {\n  Comment,\n  Component,\n  ComponentInternalInstance,\n  DirectiveBinding,\n  Fragment,\n  FunctionalComponent,\n  mergeProps,\n  ssrUtils,\n  Static,\n  Text,\n  VNode,\n  VNodeArrayChildren,\n  VNodeProps,\n  warn\n} from 'vue'\nimport {\n  escapeHtml,\n  escapeHtmlComment,\n  isFunction,\n  isPromise,\n  isString,\n  isVoidTag,\n  ShapeFlags,\n  isArray,\n  NOOP\n} from '@vue/shared'\nimport { ssrRenderAttrs } from './helpers/ssrRenderAttrs'\nimport { ssrCompile } from './helpers/ssrCompile'\nimport { ssrRenderTeleport } from './helpers/ssrRenderTeleport'\n\nconst {\n  createComponentInstance,\n  setCurrentRenderingInstance,\n  setupComponent,\n  renderComponentRoot,\n  normalizeVNode\n} = ssrUtils\n\nexport type SSRBuffer = SSRBufferItem[] & { hasAsync?: boolean }\nexport type SSRBufferItem = string | SSRBuffer | Promise<SSRBuffer>\nexport type PushFn = (item: SSRBufferItem) => void\nexport type Props = Record<string, unknown>\n\nexport type SSRContext = {\n  [key: string]: any\n  teleports?: Record<string, string>\n  __teleportBuffers?: Record<string, SSRBuffer>\n}\n\n// Each component has a buffer array.\n// A buffer array can contain one of the following:\n// - plain string\n// - A resolved buffer (recursive arrays of strings that can be unrolled\n//   synchronously)\n// - An async buffer (a Promise that resolves to a resolved buffer)\nexport function createBuffer() {\n  let appendable = false\n  const buffer: SSRBuffer = []\n  return {\n    getBuffer(): SSRBuffer {\n      // Return static buffer and await on items during unroll stage\n      return buffer\n    },\n    push(item: SSRBufferItem) {\n      const isStringItem = isString(item)\n      if (appendable && isStringItem) {\n        buffer[buffer.length - 1] += item as string\n      } else {\n        buffer.push(item)\n      }\n      appendable = isStringItem\n      if (isPromise(item) || (isArray(item) && item.hasAsync)) {\n        // promise, or child buffer with async, mark as async.\n        // this allows skipping unnecessary await ticks during unroll stage\n        buffer.hasAsync = true\n      }\n    }\n  }\n}\n\nexport function renderComponentVNode(\n  vnode: VNode,\n  parentComponent: ComponentInternalInstance | null = null,\n  slotScopeId?: string\n): SSRBuffer | Promise<SSRBuffer> {\n  const instance = createComponentInstance(vnode, parentComponent, null)\n  const res = setupComponent(instance, true /* isSSR */)\n  const hasAsyncSetup = isPromise(res)\n  const prefetches = instance.sp /* LifecycleHooks.SERVER_PREFETCH */\n  if (hasAsyncSetup || prefetches) {\n    let p: Promise<unknown> = hasAsyncSetup\n      ? (res as Promise<void>)\n      : Promise.resolve()\n    if (prefetches) {\n      p = p\n        .then(() =>\n          Promise.all(prefetches.map(prefetch => prefetch.call(instance.proxy)))\n        )\n        // Note: error display is already done by the wrapped lifecycle hook function.\n        .catch(() => {})\n    }\n    return p.then(() => renderComponentSubTree(instance, slotScopeId))\n  } else {\n    return renderComponentSubTree(instance, slotScopeId)\n  }\n}\n\nfunction renderComponentSubTree(\n  instance: ComponentInternalInstance,\n  slotScopeId?: string\n): SSRBuffer | Promise<SSRBuffer> {\n  const comp = instance.type as Component\n  const { getBuffer, push } = createBuffer()\n  if (isFunction(comp)) {\n    let root = renderComponentRoot(instance)\n    // #5817 scope ID attrs not falling through if functional component doesn't\n    // have props\n    if (!(comp as FunctionalComponent).props) {\n      for (const key in instance.attrs) {\n        if (key.startsWith(`data-v-`)) {\n          ;(root.props || (root.props = {}))[key] = ``\n        }\n      }\n    }\n    renderVNode(push, (instance.subTree = root), instance, slotScopeId)\n  } else {\n    if (\n      (!instance.render || instance.render === NOOP) &&\n      !instance.ssrRender &&\n      !comp.ssrRender &&\n      isString(comp.template)\n    ) {\n      comp.ssrRender = ssrCompile(comp.template, instance)\n    }\n\n    // perf: enable caching of computed getters during render\n    // since there cannot be state mutations during render.\n    for (const e of instance.scope.effects) {\n      if (e.computed) e.computed._cacheable = true\n    }\n\n    const ssrRender = instance.ssrRender || comp.ssrRender\n    if (ssrRender) {\n      // optimized\n      // resolve fallthrough attrs\n      let attrs = instance.inheritAttrs !== false ? instance.attrs : undefined\n      let hasCloned = false\n\n      let cur = instance\n      while (true) {\n        const scopeId = cur.vnode.scopeId\n        if (scopeId) {\n          if (!hasCloned) {\n            attrs = { ...attrs }\n            hasCloned = true\n          }\n          attrs![scopeId] = ''\n        }\n        const parent = cur.parent\n        if (parent && parent.subTree && parent.subTree === cur.vnode) {\n          // parent is a non-SSR compiled component and is rendering this\n          // component as root. inherit its scopeId if present.\n          cur = parent\n        } else {\n          break\n        }\n      }\n\n      if (slotScopeId) {\n        if (!hasCloned) attrs = { ...attrs }\n        attrs![slotScopeId.trim()] = ''\n      }\n\n      // set current rendering instance for asset resolution\n      const prev = setCurrentRenderingInstance(instance)\n      ssrRender(\n        instance.proxy,\n        push,\n        instance,\n        attrs,\n        // compiler-optimized bindings\n        instance.props,\n        instance.setupState,\n        instance.data,\n        instance.ctx\n      )\n      setCurrentRenderingInstance(prev)\n    } else if (instance.render && instance.render !== NOOP) {\n      renderVNode(\n        push,\n        (instance.subTree = renderComponentRoot(instance)),\n        instance,\n        slotScopeId\n      )\n    } else {\n      const componentName = comp.name || comp.__file || `<Anonymous>`\n      warn(`Component ${componentName} is missing template or render function.`)\n      push(`<!---->`)\n    }\n  }\n  return getBuffer()\n}\n\nexport function renderVNode(\n  push: PushFn,\n  vnode: VNode,\n  parentComponent: ComponentInternalInstance,\n  slotScopeId?: string\n) {\n  const { type, shapeFlag, children } = vnode\n  switch (type) {\n    case Text:\n      push(escapeHtml(children as string))\n      break\n    case Comment:\n      push(\n        children ? `<!--${escapeHtmlComment(children as string)}-->` : `<!---->`\n      )\n      break\n    case Static:\n      push(children as string)\n      break\n    case Fragment:\n      if (vnode.slotScopeIds) {\n        slotScopeId =\n          (slotScopeId ? slotScopeId + ' ' : '') + vnode.slotScopeIds.join(' ')\n      }\n      push(`<!--[-->`) // open\n      renderVNodeChildren(\n        push,\n        children as VNodeArrayChildren,\n        parentComponent,\n        slotScopeId\n      )\n      push(`<!--]-->`) // close\n      break\n    default:\n      if (shapeFlag & ShapeFlags.ELEMENT) {\n        renderElementVNode(push, vnode, parentComponent, slotScopeId)\n      } else if (shapeFlag & ShapeFlags.COMPONENT) {\n        push(renderComponentVNode(vnode, parentComponent, slotScopeId))\n      } else if (shapeFlag & ShapeFlags.TELEPORT) {\n        renderTeleportVNode(push, vnode, parentComponent, slotScopeId)\n      } else if (shapeFlag & ShapeFlags.SUSPENSE) {\n        renderVNode(push, vnode.ssContent!, parentComponent, slotScopeId)\n      } else {\n        warn(\n          '[@vue/server-renderer] Invalid VNode type:',\n          type,\n          `(${typeof type})`\n        )\n      }\n  }\n}\n\nexport function renderVNodeChildren(\n  push: PushFn,\n  children: VNodeArrayChildren,\n  parentComponent: ComponentInternalInstance,\n  slotScopeId: string | undefined\n) {\n  for (let i = 0; i < children.length; i++) {\n    renderVNode(push, normalizeVNode(children[i]), parentComponent, slotScopeId)\n  }\n}\n\nfunction renderElementVNode(\n  push: PushFn,\n  vnode: VNode,\n  parentComponent: ComponentInternalInstance,\n  slotScopeId: string | undefined\n) {\n  const tag = vnode.type as string\n  let { props, children, shapeFlag, scopeId, dirs } = vnode\n  let openTag = `<${tag}`\n\n  if (dirs) {\n    props = applySSRDirectives(vnode, props, dirs)\n  }\n\n  if (props) {\n    openTag += ssrRenderAttrs(props, tag)\n  }\n\n  if (scopeId) {\n    openTag += ` ${scopeId}`\n  }\n  // inherit parent chain scope id if this is the root node\n  let curParent: ComponentInternalInstance | null = parentComponent\n  let curVnode = vnode\n  while (curParent && curVnode === curParent.subTree) {\n    curVnode = curParent.vnode\n    if (curVnode.scopeId) {\n      openTag += ` ${curVnode.scopeId}`\n    }\n    curParent = curParent.parent\n  }\n  if (slotScopeId) {\n    openTag += ` ${slotScopeId}`\n  }\n\n  push(openTag + `>`)\n  if (!isVoidTag(tag)) {\n    let hasChildrenOverride = false\n    if (props) {\n      if (props.innerHTML) {\n        hasChildrenOverride = true\n        push(props.innerHTML)\n      } else if (props.textContent) {\n        hasChildrenOverride = true\n        push(escapeHtml(props.textContent))\n      } else if (tag === 'textarea' && props.value) {\n        hasChildrenOverride = true\n        push(escapeHtml(props.value))\n      }\n    }\n    if (!hasChildrenOverride) {\n      if (shapeFlag & ShapeFlags.TEXT_CHILDREN) {\n        push(escapeHtml(children as string))\n      } else if (shapeFlag & ShapeFlags.ARRAY_CHILDREN) {\n        renderVNodeChildren(\n          push,\n          children as VNodeArrayChildren,\n          parentComponent,\n          slotScopeId\n        )\n      }\n    }\n    push(`</${tag}>`)\n  }\n}\n\nfunction applySSRDirectives(\n  vnode: VNode,\n  rawProps: VNodeProps | null,\n  dirs: DirectiveBinding[]\n): VNodeProps {\n  const toMerge: VNodeProps[] = []\n  for (let i = 0; i < dirs.length; i++) {\n    const binding = dirs[i]\n    const {\n      dir: { getSSRProps }\n    } = binding\n    if (getSSRProps) {\n      const props = getSSRProps(binding, vnode)\n      if (props) toMerge.push(props)\n    }\n  }\n  return mergeProps(rawProps || {}, ...toMerge)\n}\n\nfunction renderTeleportVNode(\n  push: PushFn,\n  vnode: VNode,\n  parentComponent: ComponentInternalInstance,\n  slotScopeId: string | undefined\n) {\n  const target = vnode.props && vnode.props.to\n  const disabled = vnode.props && vnode.props.disabled\n  if (!target) {\n    if (!disabled) {\n      warn(`[@vue/server-renderer] Teleport is missing target prop.`)\n    }\n    return []\n  }\n  if (!isString(target)) {\n    warn(\n      `[@vue/server-renderer] Teleport target must be a query selector string.`\n    )\n    return []\n  }\n  ssrRenderTeleport(\n    push,\n    push => {\n      renderVNodeChildren(\n        push,\n        vnode.children as VNodeArrayChildren,\n        parentComponent,\n        slotScopeId\n      )\n    },\n    target,\n    disabled || disabled === '',\n    parentComponent\n  )\n}\n","import {\n  App,\n  createApp,\n  createVNode,\n  ssrContextKey,\n  ssrUtils,\n  VNode\n} from 'vue'\nimport { isPromise, isString } from '@vue/shared'\nimport { SSRContext, renderComponentVNode, SSRBuffer } from './render'\n\nconst { isVNode } = ssrUtils\n\nasync function unrollBuffer(buffer: SSRBuffer): Promise<string> {\n  if (buffer.hasAsync) {\n    let ret = ''\n    for (let i = 0; i < buffer.length; i++) {\n      let item = buffer[i]\n      if (isPromise(item)) {\n        item = await item\n      }\n      if (isString(item)) {\n        ret += item\n      } else {\n        ret += await unrollBuffer(item)\n      }\n    }\n    return ret\n  } else {\n    // sync buffer can be more efficiently unrolled without unnecessary await\n    // ticks\n    return unrollBufferSync(buffer)\n  }\n}\n\nfunction unrollBufferSync(buffer: SSRBuffer): string {\n  let ret = ''\n  for (let i = 0; i < buffer.length; i++) {\n    let item = buffer[i]\n    if (isString(item)) {\n      ret += item\n    } else {\n      // since this is a sync buffer, child buffers are never promises\n      ret += unrollBufferSync(item as SSRBuffer)\n    }\n  }\n  return ret\n}\n\nexport async function renderToString(\n  input: App | VNode,\n  context: SSRContext = {}\n): Promise<string> {\n  if (isVNode(input)) {\n    // raw vnode, wrap with app (for context)\n    return renderToString(createApp({ render: () => input }), context)\n  }\n\n  // rendering an app\n  const vnode = createVNode(input._component, input._props)\n  vnode.appContext = input._context\n  // provide the ssr context to the tree\n  input.provide(ssrContextKey, context)\n  const buffer = await renderComponentVNode(vnode)\n\n  const result = await unrollBuffer(buffer as SSRBuffer)\n\n  await resolveTeleports(context)\n\n  return result\n}\n\nexport async function resolveTeleports(context: SSRContext) {\n  if (context.__teleportBuffers) {\n    context.teleports = context.teleports || {}\n    for (const key in context.__teleportBuffers) {\n      // note: it's OK to await sequentially here because the Promises were\n      // created eagerly in parallel.\n      context.teleports[key] = await unrollBuffer(\n        await Promise.all([context.__teleportBuffers[key]])\n      )\n    }\n  }\n}\n","import {\n  App,\n  VNode,\n  createVNode,\n  ssrUtils,\n  createApp,\n  ssrContextKey\n} from 'vue'\nimport { isString, isPromise } from '@vue/shared'\nimport { renderComponentVNode, SSRBuffer, SSRContext } from './render'\nimport { Readable, Writable } from 'stream'\nimport { resolveTeleports } from './renderToString'\n\nconst { isVNode } = ssrUtils\n\nexport interface SimpleReadable {\n  push(chunk: string | null): void\n  destroy(err: any): void\n}\n\nasync function unrollBuffer(\n  buffer: SSRBuffer,\n  stream: SimpleReadable\n): Promise<void> {\n  if (buffer.hasAsync) {\n    for (let i = 0; i < buffer.length; i++) {\n      let item = buffer[i]\n      if (isPromise(item)) {\n        item = await item\n      }\n      if (isString(item)) {\n        stream.push(item)\n      } else {\n        await unrollBuffer(item, stream)\n      }\n    }\n  } else {\n    // sync buffer can be more efficiently unrolled without unnecessary await\n    // ticks\n    unrollBufferSync(buffer, stream)\n  }\n}\n\nfunction unrollBufferSync(buffer: SSRBuffer, stream: SimpleReadable) {\n  for (let i = 0; i < buffer.length; i++) {\n    let item = buffer[i]\n    if (isString(item)) {\n      stream.push(item)\n    } else {\n      // since this is a sync buffer, child buffers are never promises\n      unrollBufferSync(item as SSRBuffer, stream)\n    }\n  }\n}\n\nexport function renderToSimpleStream<T extends SimpleReadable>(\n  input: App | VNode,\n  context: SSRContext,\n  stream: T\n): T {\n  if (isVNode(input)) {\n    // raw vnode, wrap with app (for context)\n    return renderToSimpleStream(\n      createApp({ render: () => input }),\n      context,\n      stream\n    )\n  }\n\n  // rendering an app\n  const vnode = createVNode(input._component, input._props)\n  vnode.appContext = input._context\n  // provide the ssr context to the tree\n  input.provide(ssrContextKey, context)\n\n  Promise.resolve(renderComponentVNode(vnode))\n    .then(buffer => unrollBuffer(buffer, stream))\n    .then(() => resolveTeleports(context))\n    .then(() => stream.push(null))\n    .catch(error => {\n      stream.destroy(error)\n    })\n\n  return stream\n}\n\n/**\n * @deprecated\n */\nexport function renderToStream(\n  input: App | VNode,\n  context: SSRContext = {}\n): Readable {\n  console.warn(\n    `[@vue/server-renderer] renderToStream is deprecated - use renderToNodeStream instead.`\n  )\n  return renderToNodeStream(input, context)\n}\n\nexport function renderToNodeStream(\n  input: App | VNode,\n  context: SSRContext = {}\n): Readable {\n  const stream: Readable = __NODE_JS__\n    ? new (require('stream').Readable)({ read() {} })\n    : null\n\n  if (!stream) {\n    throw new Error(\n      `ESM build of renderToStream() does not support renderToNodeStream(). ` +\n        `Use pipeToNodeWritable() with an existing Node.js Writable stream ` +\n        `instance instead.`\n    )\n  }\n\n  return renderToSimpleStream(input, context, stream)\n}\n\nexport function pipeToNodeWritable(\n  input: App | VNode,\n  context: SSRContext = {},\n  writable: Writable\n) {\n  renderToSimpleStream(input, context, {\n    push(content) {\n      if (content != null) {\n        writable.write(content)\n      } else {\n        writable.end()\n      }\n    },\n    destroy(err) {\n      writable.destroy(err)\n    }\n  })\n}\n\nexport function renderToWebStream(\n  input: App | VNode,\n  context: SSRContext = {}\n): ReadableStream {\n  if (typeof ReadableStream !== 'function') {\n    throw new Error(\n      `ReadableStream constructor is not available in the global scope. ` +\n        `If the target environment does support web streams, consider using ` +\n        `pipeToWebWritable() with an existing WritableStream instance instead.`\n    )\n  }\n\n  const encoder = new TextEncoder()\n  let cancelled = false\n\n  return new ReadableStream({\n    start(controller) {\n      renderToSimpleStream(input, context, {\n        push(content) {\n          if (cancelled) return\n          if (content != null) {\n            controller.enqueue(encoder.encode(content))\n          } else {\n            controller.close()\n          }\n        },\n        destroy(err) {\n          controller.error(err)\n        }\n      })\n    },\n    cancel() {\n      cancelled = true\n    }\n  })\n}\n\nexport function pipeToWebWritable(\n  input: App | VNode,\n  context: SSRContext = {},\n  writable: WritableStream\n): void {\n  const writer = writable.getWriter()\n  const encoder = new TextEncoder()\n\n  // #4287 CloudFlare workers do not implement `ready` property\n  let hasReady = false\n  try {\n    hasReady = isPromise(writer.ready)\n  } catch (e: any) {}\n\n  renderToSimpleStream(input, context, {\n    async push(content) {\n      if (hasReady) {\n        await writer.ready\n      }\n      if (content != null) {\n        return writer.write(encoder.encode(content))\n      } else {\n        return writer.close()\n      }\n    },\n    destroy(err) {\n      // TODO better error handling?\n      console.log(err)\n      writer.close()\n    }\n  })\n}\n","import { Component, ComponentInternalInstance, createVNode, Slots } from 'vue'\nimport { Props, renderComponentVNode, SSRBuffer } from '../render'\nimport { SSRSlots } from './ssrRenderSlot'\n\nexport function ssrRenderComponent(\n  comp: Component,\n  props: Props | null = null,\n  children: Slots | SSRSlots | null = null,\n  parentComponent: ComponentInternalInstance | null = null,\n  slotScopeId?: string\n): SSRBuffer | Promise<SSRBuffer> {\n  return renderComponentVNode(\n    createVNode(comp, props, children),\n    parentComponent,\n    slotScopeId\n  )\n}\n","import { ComponentInternalInstance, Slots } from 'vue'\nimport { Props, PushFn, renderVNodeChildren, SSRBufferItem } from '../render'\nimport { isArray } from '@vue/shared'\n\nexport type SSRSlots = Record<string, SSRSlot>\nexport type SSRSlot = (\n  props: Props,\n  push: PushFn,\n  parentComponent: ComponentInternalInstance | null,\n  scopeId: string | null\n) => void\n\nexport function ssrRenderSlot(\n  slots: Slots | SSRSlots,\n  slotName: string,\n  slotProps: Props,\n  fallbackRenderFn: (() => void) | null,\n  push: PushFn,\n  parentComponent: ComponentInternalInstance,\n  slotScopeId?: string\n) {\n  // template-compiled slots are always rendered as fragments\n  push(`<!--[-->`)\n  ssrRenderSlotInner(\n    slots,\n    slotName,\n    slotProps,\n    fallbackRenderFn,\n    push,\n    parentComponent,\n    slotScopeId\n  )\n  push(`<!--]-->`)\n}\n\nexport function ssrRenderSlotInner(\n  slots: Slots | SSRSlots,\n  slotName: string,\n  slotProps: Props,\n  fallbackRenderFn: (() => void) | null,\n  push: PushFn,\n  parentComponent: ComponentInternalInstance,\n  slotScopeId?: string,\n  transition?: boolean\n) {\n  const slotFn = slots[slotName]\n  if (slotFn) {\n    const slotBuffer: SSRBufferItem[] = []\n    const bufferedPush = (item: SSRBufferItem) => {\n      slotBuffer.push(item)\n    }\n    const ret = slotFn(\n      slotProps,\n      bufferedPush,\n      parentComponent,\n      slotScopeId ? ' ' + slotScopeId : ''\n    )\n    if (isArray(ret)) {\n      // normal slot\n      renderVNodeChildren(push, ret, parentComponent, slotScopeId)\n    } else {\n      // ssr slot.\n      // check if the slot renders all comments, in which case use the fallback\n      let isEmptySlot = true\n      if (transition) {\n        isEmptySlot = false\n      } else {\n        for (let i = 0; i < slotBuffer.length; i++) {\n          if (!isComment(slotBuffer[i])) {\n            isEmptySlot = false\n            break\n          }\n        }\n      }\n      if (isEmptySlot) {\n        if (fallbackRenderFn) {\n          fallbackRenderFn()\n        }\n      } else {\n        for (let i = 0; i < slotBuffer.length; i++) {\n          push(slotBuffer[i])\n        }\n      }\n    }\n  } else if (fallbackRenderFn) {\n    fallbackRenderFn()\n  }\n}\n\nconst commentTestRE = /^<!--.*-->$/s\nconst commentRE = /<!--[^]*?-->/gm\nfunction isComment(item: SSRBufferItem) {\n  if (typeof item !== 'string' || !commentTestRE.test(item)) return false\n  // if item is '<!---->' or '<!--[-->' or '<!--]-->', return true directly\n  if (item.length <= 8) return true\n  return !item.replace(commentRE, '').trim()\n}\n","import { escapeHtml, toDisplayString } from '@vue/shared'\n\nexport function ssrInterpolate(value: unknown): string {\n  return escapeHtml(toDisplayString(value))\n}\n","import { isArray, isString, isObject } from '@vue/shared'\nimport { warn } from '@vue/runtime-core'\n\nexport function ssrRenderList(\n  source: unknown,\n  renderItem: (value: unknown, key: string | number, index?: number) => void\n) {\n  if (isArray(source) || isString(source)) {\n    for (let i = 0, l = source.length; i < l; i++) {\n      renderItem(source[i], i)\n    }\n  } else if (typeof source === 'number') {\n    if (__DEV__ && !Number.isInteger(source)) {\n      warn(`The v-for range expect an integer value but got ${source}.`)\n      return\n    }\n    for (let i = 0; i < source; i++) {\n      renderItem(i + 1, i)\n    }\n  } else if (isObject(source)) {\n    if (source[Symbol.iterator as any]) {\n      const arr = Array.from(source as Iterable<any>)\n      for (let i = 0, l = arr.length; i < l; i++) {\n        renderItem(arr[i], i)\n      }\n    } else {\n      const keys = Object.keys(source)\n      for (let i = 0, l = keys.length; i < l; i++) {\n        const key = keys[i]\n        renderItem(source[key], key, i)\n      }\n    }\n  }\n}\n","import { PushFn } from '../render'\n\nexport async function ssrRenderSuspense(\n  push: PushFn,\n  { default: renderContent }: Record<string, (() => void) | undefined>\n) {\n  if (renderContent) {\n    renderContent()\n  } else {\n    push(`<!---->`)\n  }\n}\n","import { ComponentPublicInstance, Directive } from '@vue/runtime-core'\n\nexport function ssrGetDirectiveProps(\n  instance: ComponentPublicInstance,\n  dir: Directive,\n  value?: any,\n  arg?: string,\n  modifiers: Record<string, boolean> = {}\n): Record<string, any> {\n  if (typeof dir !== 'function' && dir.getSSRProps) {\n    return (\n      dir.getSSRProps(\n        {\n          dir,\n          instance,\n          value,\n          oldValue: undefined,\n          arg,\n          modifiers\n        },\n        null as any\n      ) || {}\n    )\n  }\n  return {}\n}\n","import { looseEqual, looseIndexOf, isArray } from '@vue/shared'\nimport { ssrRenderAttr } from './ssrRenderAttrs'\n\nexport const ssrLooseEqual = looseEqual as (a: unknown, b: unknown) => boolean\n\nexport function ssrLooseContain(arr: unknown[], value: unknown): boolean {\n  return looseIndexOf(arr, value) > -1\n}\n\n// for <input :type=\"type\" v-model=\"model\" value=\"value\">\nexport function ssrRenderDynamicModel(\n  type: unknown,\n  model: unknown,\n  value: unknown\n) {\n  switch (type) {\n    case 'radio':\n      return looseEqual(model, value) ? ' checked' : ''\n    case 'checkbox':\n      return (isArray(model) ? ssrLooseContain(model, value) : model)\n        ? ' checked'\n        : ''\n    default:\n      // text types\n      return ssrRenderAttr('value', model)\n  }\n}\n\n// for <input v-bind=\"obj\" v-model=\"model\">\nexport function ssrGetDynamicModelProps(\n  existingProps: any = {},\n  model: unknown\n) {\n  const { type, value } = existingProps\n  switch (type) {\n    case 'radio':\n      return looseEqual(model, value) ? { checked: true } : null\n    case 'checkbox':\n      return (isArray(model) ? ssrLooseContain(model, value) : model)\n        ? { checked: true }\n        : null\n    default:\n      // text types\n      return { value: model }\n  }\n}\n","import { initDirectivesForSSR } from 'vue'\ninitDirectivesForSSR()\n\n// public\nexport { SSRContext } from './render'\nexport { renderToString } from './renderToString'\nexport {\n  renderToSimpleStream,\n  renderToNodeStream,\n  pipeToNodeWritable,\n  renderToWebStream,\n  pipeToWebWritable,\n  SimpleReadable,\n  // deprecated\n  renderToStream\n} from './renderToStream'\n\n// internal runtime helpers\nexport { renderVNode as ssrRenderVNode } from './render'\nexport { ssrRenderComponent } from './helpers/ssrRenderComponent'\nexport { ssrRenderSlot, ssrRenderSlotInner } from './helpers/ssrRenderSlot'\nexport { ssrRenderTeleport } from './helpers/ssrRenderTeleport'\nexport {\n  ssrRenderClass,\n  ssrRenderStyle,\n  ssrRenderAttrs,\n  ssrRenderAttr,\n  ssrRenderDynamicAttr\n} from './helpers/ssrRenderAttrs'\nexport { ssrInterpolate } from './helpers/ssrInterpolate'\nexport { ssrRenderList } from './helpers/ssrRenderList'\nexport { ssrRenderSuspense } from './helpers/ssrRenderSuspense'\nexport { ssrGetDirectiveProps } from './helpers/ssrGetDirectiveProps'\nexport { includeBooleanAttr as ssrIncludeBooleanAttr } from '@vue/shared'\n\n// v-model helpers\nexport {\n  ssrLooseEqual,\n  ssrLooseContain,\n  ssrRenderDynamicModel,\n  ssrGetDynamicModelProps\n} from './helpers/ssrVModelHelpers'\n"],"names":["makeMap","isOn","propsToAttrMap","isBooleanAttr","includeBooleanAttr","isSSRSafeAttrName","escapeHtml","normalizeClass","isString","normalizeStyle","stringifyStyle","extend","NO","isFunction","compile","ssrContextKey","ssrUtils","isPromise","isArray","NOOP","warn","Text","Comment","escapeHtmlComment","Static","Fragment","isVoidTag","mergeProps","createApp","createVNode","isVNode","unrollBuffer","unrollBufferSync","toDisplayString","isObject","looseEqual","looseIndexOf","initDirectivesForSSR"],"mappings":"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"}